El modelo que escogimos se describe a continuación, en este entran en juego distintos parametros de distribuciones que modelan el problema y datos obtenidos que nos ayudaran a predecir mejor las distribuciones de los parámetros. Los cálculos de inferencia se realizaran con JAGS. Mas adelante se describe el código utilizado en el código del modelo.

\begin{figure}[H]
\begin{minipage}{0.5\textwidth}
\centering
\begin{tikzpicture}[>=stealth', shorten >=1pt,auto,node distance=1.9cm,
                    semithick]
  \tikzstyle{every state}=[fill=white,draw=black,text=black]

	\node[state, rectangle]	(0)							{$\alpha$};
	\node[state]				(1) [right of=0, below of=0]	{$\theta_3$};
	\node[state]				(3) [left of=0, below of=0]	{$\theta_1$};
	\node[state]				(2) [below of=0] 			{$\theta_2$};
	\node[state, rectangle]	(5) [below of=2, fill=gray] 	{$k_2$};
	\node[state, rectangle]	(4) [below of=1, fill=gray]	{$k_3$};
	\node[state, rectangle]	(6) [below of=3, fill=gray] 	{$k_1$};
	\node[state, rectangle]	(7) [below of=5, fill=gray] 	{$n$};

	\path[->]	
			(0) edge  []						node {} (1)
				edge  []						node {} (2)
				edge	  []						node {} (3)			
			(1) edge  []  					node {} (4)
			(2) edge  []						node {} (5)
			(3)	edge  [] 					node {} (6)
			(7) edge  []  					node {} (4)
				edge  []						node {} (5)
        			edge  [] 					node {} (6);

\end{tikzpicture}
\end{minipage}%
\begin{minipage}{0.5\textwidth}

$\beta \sim Categorical(pi)$

$
  \theta_1 \sim
\begin{cases}
  Beta(0.5,0.5)	& \text{if}\ \beta = 1 \\
  Beta(100,100)	& \text{if}\ \beta \neq 1
\end{cases}
$

$ k_1 \sim Binomial(\theta_1,n) $

$ k_2 \sim Binomial(\theta_2,n) $

$ k_3 \sim Binomial(\theta_3,n) $

$ n = 10  $

\end{minipage}
\end{figure}

\begin{lstlisting}[frame=single]
model{  
	# Observed Counts
	k1 ~ dbin(theta1,n)
	k2 ~ dbin(theta2,n)
	k3 ~ dbin(theta3,n)

	# Prior on Rates Theta
	theta1 ~ dbeta(param1, param1)
	theta2 ~ dbeta(param2, param2)
	theta3 ~ dbeta(param3, param3)

	# Auxiliary variables for Theta's distribution
	param1 <- ifelse(alpha== 1, 0.5, 100)
	param2 <- ifelse(alpha== 2, 0.5, 100)
	param3 <- ifelse(alpha== 3, 0.5, 100)

	# Prior on Rate Alpha
	for( i in 1:3){
	pi[i] <- 1/3
	}
	alpha ~ dcat(pi[])	
}
\end{lstlisting}


